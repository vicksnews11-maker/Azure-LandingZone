trigger: none

pool:
  name: Myagent

stages:

# ------------------------- #
# Stage 1 : Build using your agent
# ------------------------- #
- stage: Build
  displayName: "Build Stage"
  jobs:
  - job: RunTests
    displayName: "Run Test Job"
    pool:
      name: Myagent   # Self-hosted agent
    steps:
    - script: echo "Running tests..."
      displayName: "Test Step"

# ------------------------- #
# Stage 2 : Manual Approval (Agentless)
# ------------------------- #
- stage: Approval
  displayName: "Manual Approval Stage"
  dependsOn: Build

  jobs:
  - job: ManualApproval
    displayName: "Agentless Manual Approval"
    pool: server     # Required for approval / manual validation
    steps:
    - task: ManualValidation@1
      inputs:
        notifyUsers: |
          user1@shaiksk2025outlook.onmicrosoft.com
        approvers: |
          vicks@shaiksk2025outlook.onmicrosoft.com
        instructions: "Please approve to proceed."
        onTimeout: 'reject'
        timeout: '0'   # 0 = no timeout
